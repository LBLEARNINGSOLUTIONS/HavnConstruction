<template>
  <div class="ira-lesson">
    <!-- Header -->
    <div class="lesson-header">
      <div class="logo-mark">
        <svg viewBox="0 0 40 40" class="house-icon">
          <path d="M20 4L4 18h5v14h22V18h5L20 4zm-6 26V22h12v8H14z" fill="currentColor"/>
        </svg>
      </div>
      <h1 class="lesson-title">Day in the Life - Knocking Installs</h1>
    </div>

    <!-- Video Section -->
    <div class="video-section">
      <div class="video-wrapper">
        <iframe
          src="https://www.youtube.com/embed/f7BKsJgUZHw"
          title="Day in the Life - Knocking Installs"
          frameborder="0"
          allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
          allowfullscreen
        ></iframe>
      </div>
    </div>

    <!-- The Big Picture -->
    <div class="content-section">
      <h2 class="section-heading">The Big Picture</h2>
      <div class="card-grid">
        <div class="info-card">
          <div class="card-icon what-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <circle cx="12" cy="12" r="10"/>
              <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"/>
              <line x1="12" y1="17" x2="12.01" y2="17"/>
            </svg>
          </div>
          <h3 class="card-title">What It Is</h3>
          <p class="card-text">
            This process is about leveraging active installs in a neighborhood to generate new leads. When neighbors see shingles on a roof, trucks in the driveway, and work being done, it creates instant credibility and curiosity. Knocking installs turns one approved claim into five or more by using visibility, trust, and referrals.
          </p>
        </div>

        <div class="info-card">
          <div class="card-icon why-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M12 2l3.09 6.26L22 9.27l-5 4.87 1.18 6.88L12 17.77l-6.18 3.25L7 14.14 2 9.27l6.91-1.01L12 2z"/>
            </svg>
          </div>
          <h3 class="card-title">Why It Matters</h3>
          <p class="card-text">
            Every install is proof that insurance pays for roofs. It's much easier to start conversations when homeowners can see the process happening next door. This isn't cold knocking ‚Äî it's hot territory. Using installs effectively helps you dominate a block, multiply deals, and scale your impact.
          </p>
        </div>

        <div class="info-card">
          <div class="card-icon how-icon">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
              <path d="M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z"/>
            </svg>
          </div>
          <h3 class="card-title">How It Fits</h3>
          <p class="card-text">
            This is part of your prospecting and lead generation strategy. After an install is approved and in progress, your role is to maximize its visibility by knocking nearby homes, encouraging your customer to share their story online, and asking for referrals.
          </p>
        </div>
      </div>
    </div>

    <!-- Watch Out -->
    <div class="content-section warning-section">
      <h2 class="section-heading">Watch Out</h2>
      <p class="section-subtext">Common mistakes that limit your results:</p>
      <ul class="warning-list">
        <li class="warning-item">
          <span class="warning-icon">‚úï</span>
          <span>Treating installs like regular cold knocking opportunities</span>
        </li>
        <li class="warning-item">
          <span class="warning-icon">‚úï</span>
          <span>Forgetting to point out that insurance is covering the roof</span>
        </li>
        <li class="warning-item">
          <span class="warning-icon">‚úï</span>
          <span>Not asking customers to post about their experience online</span>
        </li>
        <li class="warning-item">
          <span class="warning-icon">‚úï</span>
          <span>Skipping the referral ask after trust is already established</span>
        </li>
        <li class="warning-item">
          <span class="warning-icon">‚úï</span>
          <span>Only knocking one or two doors instead of canvassing the entire block</span>
        </li>
      </ul>
    </div>

    <!-- Your Toolkit -->
    <div class="content-section">
      <h2 class="section-heading">Your Toolkit</h2>
      <p class="section-subtext">Have these ready before you start:</p>
      <ul class="toolkit-list">
        <li class="toolkit-item">
          <span class="check-icon">‚úì</span>
          <span>Install schedule (know where crews will be working)</span>
        </li>
        <li class="toolkit-item">
          <span class="check-icon">‚úì</span>
          <span>Door knocking script for installs</span>
        </li>
        <li class="toolkit-item">
          <span class="check-icon">‚úì</span>
          <span>Flyers or leave-behinds referencing "We're working with your neighbor"</span>
        </li>
        <li class="toolkit-item">
          <span class="check-icon">‚úì</span>
          <span>Phone/camera to capture social proof from installs</span>
        </li>
        <li class="toolkit-item">
          <span class="check-icon">‚úì</span>
          <span>Customer referral ask (simple and clear)</span>
        </li>
      </ul>
    </div>

    <!-- Example Scripts -->
    <div class="content-section">
      <h2 class="section-heading">Example Scripts</h2>
      <p class="section-subtext">Use these phrases when knocking around installs:</p>
      <div class="scripts-list">
        <div class="script-item">
          <span class="script-icon">üí¨</span>
          <p class="script-text">"Hey, we're just doing your neighbor's roof a couple doors down. We actually got their insurance company to pay for it because of storm damage. When was the last time someone looked at your roof?"</p>
        </div>
        <div class="script-item">
          <span class="script-icon">üí¨</span>
          <p class="script-text">"Your neighbor had similar damage, and insurance covered everything except the deductible."</p>
        </div>
        <div class="script-item">
          <span class="script-icon">üí¨</span>
          <p class="script-text">"If you'd like, I can do a quick inspection today so you know if you qualify too."</p>
        </div>
        <div class="script-item">
          <span class="script-icon">üí¨</span>
          <p class="script-text">"Would you be open to sharing your story online? It helps more neighbors learn how insurance works."</p>
        </div>
      </div>
    </div>

    <!-- Practice It -->
    <div class="content-section">
      <h2 class="section-heading">Practice It</h2>
      <div class="practice-grid">
        <div class="practice-card solo">
          <div class="practice-header">
            <span class="practice-emoji">üë§</span>
            <h3 class="practice-title">Solo Practice</h3>
          </div>
          <ol class="practice-list">
            <li>Write out your personal version of the install knock script.</li>
            <li>Practice explaining the difference between cold knocking and knocking installs.</li>
            <li>Make a list of 3 ways you can ask a happy customer for referrals.</li>
          </ol>
        </div>

        <div class="practice-card peer">
          <div class="practice-header">
            <span class="practice-emoji">üë•</span>
            <h3 class="practice-title">Peer Practice</h3>
          </div>
          <ol class="practice-list">
            <li>Roleplay an install knock with a teammate ‚Äî one as the rep, one as the neighbor.</li>
            <li>Practice transitioning from "We're working with your neighbor" to "Let's do a quick inspection."</li>
            <li>Share referral ask strategies and give each other feedback on tone and confidence.</li>
          </ol>
        </div>

        <div class="practice-card field">
          <div class="practice-header">
            <span class="practice-emoji">üè°</span>
            <h3 class="practice-title">In the Field</h3>
          </div>
          <ol class="practice-list">
            <li>Attend at least one install this week and knock every house on the block.</li>
            <li>Ask your install customer to post online about their insurance experience.</li>
            <li>Track how many referrals or inspections came directly from installs.</li>
          </ol>
        </div>
      </div>
    </div>

    <!-- Completion Button -->
    <div class="completion-section">
      <button 
        class="completion-button" 
        :class="{ completed: isCompleted }"
        @click="complete"
        :disabled="isCompleted"
      >
        <span v-if="!isCompleted">I've Reviewed This Lesson</span>
        <span v-else>‚úì Completed</span>
      </button>
    </div>
  </div>
</template>

<style scoped>
.ira-lesson {
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
  max-width: 800px;
  margin: 0 auto;
  padding: 20px;
  color: #333;
  line-height: 1.6;
}

/* Header */
.lesson-header {
  text-align: center;
  margin-bottom: 32px;
}

.logo-mark {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 48px;
  height: 48px;
  color: #F5A623;
  margin-bottom: 12px;
}

.house-icon {
  width: 100%;
  height: 100%;
}

.lesson-title {
  font-size: 1.75rem;
  font-weight: 700;
  color: #5B2D86;
  margin: 0;
}

/* Video Section */
.video-section {
  margin-bottom: 40px;
}

.video-wrapper {
  position: relative;
  padding-bottom: 56.25%;
  height: 0;
  overflow: hidden;
  border-radius: 12px;
  box-shadow: 0 4px 20px rgba(91, 45, 134, 0.15);
}

.video-wrapper iframe {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
}

/* Section Styles */
.content-section {
  margin-bottom: 40px;
}

.section-heading {
  font-size: 1.35rem;
  font-weight: 700;
  color: #5B2D86;
  margin: 0 0 8px 0;
  padding-bottom: 8px;
  border-bottom: 3px solid #F5A623;
  display: inline-block;
}

.section-subtext {
  color: #666;
  margin: 0 0 16px 0;
  font-size: 0.95rem;
}

/* Info Cards Grid */
.card-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
  gap: 20px;
}

.info-card {
  background: #fff;
  border-radius: 12px;
  padding: 24px;
  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
  border-top: 4px solid #F5A623;
}

.card-icon {
  width: 40px;
  height: 40px;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  margin-bottom: 12px;
}

.card-icon svg {
  width: 22px;
  height: 22px;
}

.what-icon {
  background: rgba(245, 166, 35, 0.15);
  color: #F5A623;
}

.why-icon {
  background: rgba(91, 45, 134, 0.1);
  color: #5B2D86;
}

.how-icon {
  background: rgba(245, 166, 35, 0.15);
  color: #E8940F;
}

.card-title {
  font-size: 1.1rem;
  font-weight: 600;
  color: #5B2D86;
  margin: 0 0 8px 0;
}

.card-text {
  font-size: 0.95rem;
  color: #555;
  margin: 0;
}

/* Warning Section */
.warning-section {
  background: linear-gradient(135deg, #fff5f5 0%, #fff 100%);
  padding: 24px;
  border-radius: 12px;
  border-left: 4px solid #e53935;
}

.warning-list {
  list-style: none;
  padding: 0;
  margin: 0;
}

.warning-item {
  display: flex;
  align-items: flex-start;
  gap: 12px;
  padding: 12px 0;
  border-bottom: 1px solid rgba(0, 0, 0, 0.06);
}

.warning-item:last-child {
  border-bottom: none;
  padding-bottom: 0;
}

.warning-icon {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  background: #e53935;
  color: #fff;
  border-radius: 50%;
  font-size: 12px;
  font-weight: bold;
  flex-shrink: 0;
}

/* Toolkit Section */
.toolkit-list {
  list-style: none;
  padding: 16px 24px;
  margin: 0;
  background: #fff;
  border-radius: 12px;
  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
}

.toolkit-item {
  display: flex;
  align-items: center;
  gap: 12px;
  padding: 12px 0;
  border-bottom: 1px solid rgba(0, 0, 0, 0.06);
}

.toolkit-item:last-child {
  border-bottom: none;
  padding-bottom: 0;
}

.check-icon {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 24px;
  height: 24px;
  background: #F5A623;
  color: #fff;
  border-radius: 50%;
  font-size: 14px;
  font-weight: bold;
  flex-shrink: 0;
}

/* Scripts Section */
.scripts-list {
  background: #fff;
  border-radius: 12px;
  padding: 8px 24px;
  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
}

.script-item {
  display: flex;
  align-items: flex-start;
  gap: 12px;
  padding: 16px 0;
  border-bottom: 1px solid rgba(0, 0, 0, 0.06);
}

.script-item:last-child {
  border-bottom: none;
}

.script-icon {
  font-size: 1.25rem;
  flex-shrink: 0;
}

.script-text {
  margin: 0;
  font-style: italic;
  color: #444;
  font-size: 0.95rem;
  line-height: 1.5;
}

/* Practice Section */
.practice-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
  gap: 20px;
}

.practice-card {
  background: #fff;
  border-radius: 12px;
  padding: 24px;
  box-shadow: 0 2px 12px rgba(0, 0, 0, 0.08);
}

.practice-card.solo {
  border-top: 4px solid #F5A623;
}

.practice-card.peer {
  border-top: 4px solid #5B2D86;
}

.practice-card.field {
  border-top: 4px solid #2E7D32;
}

.practice-header {
  display: flex;
  align-items: center;
  gap: 12px;
  margin-bottom: 16px;
}

.practice-emoji {
  font-size: 1.5rem;
}

.practice-title {
  font-size: 1.1rem;
  font-weight: 600;
  color: #5B2D86;
  margin: 0;
}

.practice-list {
  margin: 0;
  padding-left: 20px;
  color: #555;
}

.practice-list li {
  margin-bottom: 12px;
}

.practice-list li:last-child {
  margin-bottom: 0;
}

/* Completion Section */
.completion-section {
  text-align: center;
  padding: 32px 0 16px;
}

.completion-button {
  background: linear-gradient(135deg, #5B2D86 0%, #7B4BA6 100%);
  color: #fff;
  border: none;
  padding: 16px 48px;
  font-size: 1.1rem;
  font-weight: 600;
  border-radius: 50px;
  cursor: pointer;
  transition: all 0.3s ease;
  box-shadow: 0 4px 15px rgba(91, 45, 134, 0.3);
}

.completion-button:hover:not(:disabled) {
  transform: translateY(-2px);
  box-shadow: 0 6px 20px rgba(91, 45, 134, 0.4);
}

.completion-button:active:not(:disabled) {
  transform: translateY(0);
}

.completion-button.completed {
  background: linear-gradient(135deg, #F5A623 0%, #E8940F 100%);
  cursor: default;
  box-shadow: 0 4px 15px rgba(245, 166, 35, 0.3);
}

/* Mobile Responsive */
@media (max-width: 600px) {
  .ira-lesson {
    padding: 16px;
  }

  .lesson-title {
    font-size: 1.4rem;
  }

  .section-heading {
    font-size: 1.2rem;
  }

  .card-grid,
  .practice-grid {
    grid-template-columns: 1fr;
  }

  .info-card,
  .practice-card {
    padding: 20px;
  }

  .completion-button {
    width: 100%;
    padding: 16px 24px;
  }
}
</style>

<script lang='es6'>
module.exports = {
  name: 'KnockingInstallsLesson',

  props: ['ctx', 'ui', 'api'],

  data() {
    return {
      isCompleted: false
    };
  },

  beforeMount() {
    this.$options.components = this.ui;
  },

  computed: {
    learner() {
      return this.ctx?.learner || {};
    },
    learnerName() {
      return this.learner.first_name || 'there';
    }
  },

  methods: {
    complete() {
      if (this.isCompleted) return;
      this.isCompleted = true;
      this.$emit('completed');
    }
  },

  mounted() {
    this.$emit('loaded');
  }
};
</script>
